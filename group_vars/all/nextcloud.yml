---

nextcloud_name: nextcloud
nextcloud_image: "nextcloud:16.0.5-{{ nextcloud_build_folder }}"
nextcloud_ports:
  - 80:80
nextcloud_directory: "{{ common_directory_config }}/nextcloud"
nextcloud_environment_variables:
  NEXTCLOUD_ADMIN_USER: "{{ common_user }}"
  NEXTCLOUD_ADMIN_PASSWORD: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34373162656662326631363762383431623164666236666434306665316263303035316336303163
          6665626235353661313363633732383734343237356165640a333966663962356561346362366635
          32393133663937386338343839346662623631306333653833356634393833326465613932353931
          3138613230353462620a383130653733326661386336393737643233396464353061386431316264
          64663865643961313431333430373362353366323836386238623831646139356537
  NEXTCLOUD_TRUSTED_DOMAINS: "{{ ansible_host }} nextcloud.{{ internal_domain }} {{ nextcloud_domain }} {{ nextcloud_name }}.{{ docker_networks[0].name }}"
  NEXTCLOUD_UPDATE: "1"
  MYSQL_DATABASE: "{{ mariadb_environment_variables.MYSQL_DATABASE }}"
  MYSQL_USER: "root"
  MYSQL_PASSWORD: "{{ mariadb_environment_variables.MYSQL_ROOT_PASSWORD }}"
  MYSQL_HOST: "{{ mariadb_name }}.{{ docker_networks[0].name }}"
  SMTP_NAME: !vault |
            $ANSIBLE_VAULT;1.1;AES256
            31613033373039306462653261343533623666326136313432373436343838313836376537343862
            3534373839326462626466663031366134386233666464650a666364316531306463353631346533
            63313263363064373539613936643438623337393830653334373166356365666633386662616165
            6464343238626166300a316236656236303261303263623062663737386134393265323939306433
            64633638653032373335303637396439386461653366623064366634393566353664
  SMTP_PASSWORD: !vault |
            $ANSIBLE_VAULT;1.1;AES256
            38396439373765623632353932333634316539366566333665353538633130346237653232363336
            6237653564323739393064316336396534343763643361300a636530666265313462646431646435
            65396434363333633730303533306231313135396262643734663266396532646437666238396137
            6464663039633562330a386238656362663664323833356563343533363163316134316331623332
            63376436656435613064313936613931373761316464313065383464396666376632
  SMTP_PORT: "465"
  SMTP_HOST: "smtp.gmail.com"
  SMTP_SECURE: "ssl"

nextcloud_docker_additional_options:
  restart_policy: unless-stopped
  networks: "{{ docker_networks }}"
  labels:
    traefik.frontend.rule: "Host:{{ common_tld }}"
    # HSTS
    traefik.frontend.headers.STSSeconds: "31536000"
    traefik.frontend.headers.STSIncludeSubdomains: "true"
    traefik.frontend.headers.STSPreload: "true"

nextcloud_build_image: true
nextcloud_build_folder: "full"
